{"version":3,"file":"placement.min.js","sources":["../src/placement.js"],"sourcesContent":["define([\n    'aiplacement_courseassist/placement',\n    'core/templates',\n    'core/ajax',\n    'core/notification',\n    'core/str'\n], function(Base, Templates, Ajax, Notification, Str) {\n\n    const SELECTOR_CLASSIFY    = '[data-action=\"classify\"]';\n    const SELECTOR_CANCEL      = '[data-action=\"cancel\"]';\n    const SELECTOR_CONTINUE    = '[data-action=\"continue\"]';\n    const SELECTOR_BACK        = '[data-action=\"back\"]';\n    const SELECTOR_PRESELECT   = '#classify-preselect';\n    const SELECTOR_DOMAINS  = 'input[name=\"classify-domains\"]';\n    const ID_CLOSE_BTN         = '#ai-classify-drawer-close';\n\n    return class ClassifyPlacement extends Base {\n        constructor(userId, contextId) {\n            super(userId, contextId);\n\n            this.aiDrawerElement      = document.querySelector('#ai-classify-drawer');\n            this.aiDrawerBodyElement  = this.aiDrawerElement.querySelector('.ai-drawer-body');\n            this.aiDrawerCloseElement = this.aiDrawerElement.querySelector(ID_CLOSE_BTN);\n            if (this.aiDrawerCloseElement) {\n                this.aiDrawerCloseElement.addEventListener('click', e => {\n                    e.preventDefault();\n                    this.closeAIDrawer();\n                });\n            }\n\n            this._domains = [];\n            this.registerExtraListener();\n        }\n\n        registerExtraListener() {\n            document.addEventListener('click', async e => {\n                const btn = e.target.closest(SELECTOR_CLASSIFY);\n                if (!btn) return;\n\n                e.preventDefault();\n                this.openAIDrawer();\n\n                let prompt = '';\n                const tex = document.querySelector('#id_introeditor');\n                prompt = tex ? tex.value.trim() : this.getTextContent().trim();\n\n                if (!prompt) {\n                    Notification.error('No content found to classify.');\n                    return;\n                }\n\n                await this.showSelectFramework(prompt);\n            });\n        }\n\n        // === STEP 1: Select framework ===\n        async showSelectFramework(prompt) {\n            this.aiDrawerBodyElement.dataset.cancelled = '0';\n\n            const prestepHtml = await Templates.render('aiplacement_classifyassist/framework_select', {});\n            this.aiDrawerBodyElement.innerHTML = prestepHtml;\n\n            const select = this.aiDrawerBodyElement.querySelector(SELECTOR_PRESELECT);\n            if (select) {\n                select.innerHTML = '<option value=\"\" disabled selected>Loadingâ€¦</option>';\n            }\n\n            try {\n                const calls = Ajax.call([{\n                    methodname: 'core_competency_list_competency_frameworks',\n                    args: {\n                        sort: 'shortname',\n                        order: 'ASC',\n                        skip: 0,\n                        context: { contextid: 1, instanceid: 0 },\n                    }\n                }]);\n\n                const res = await calls[0];\n                const frameworks = Array.isArray(res?.frameworks) ? res.frameworks\n                                : Array.isArray(res) ? res\n                                : [];\n\n                if (select) {\n                    select.innerHTML = '';\n\n                    if (!frameworks.length) {\n                        select.innerHTML = '<option value=\"\" disabled selected>No frameworks found</option>';\n                    } else {\n                        const ph = document.createElement('option');\n                        ph.value = '';\n                        ph.disabled = true;\n                        ph.selected = true;\n                        ph.textContent = 'Select Competency Framework...';\n                        select.appendChild(ph);\n\n                        frameworks.forEach(fw => {\n                            const opt = document.createElement('option');\n                            opt.value = String(fw.id);\n                            opt.textContent = fw.shortname || fw.name || fw.idnumber || `Framework #${fw.id}`;\n                            opt.dataset.shortname = fw.shortname || '';\n                            opt.dataset.idnumber = fw.idnumber || '';\n                            select.appendChild(opt);\n                        });\n                    }\n                }\n            } catch (error) {\n                if (select) {\n                    select.innerHTML = '<option value=\"\" disabled selected>Failed to load frameworks</option>';\n                }\n                Notification.exception(error);\n            }\n\n            const continueBtn = this.aiDrawerBodyElement.querySelector(SELECTOR_CONTINUE);\n            const sel        = this.aiDrawerBodyElement.querySelector(SELECTOR_PRESELECT);\n            const backBtn    = this.aiDrawerBodyElement.querySelector(SELECTOR_BACK);\n            const cancelBtn  = this.aiDrawerBodyElement.querySelector(SELECTOR_CANCEL);\n\n            if (continueBtn) {\n                continueBtn.disabled = true;\n\n                const updateContinueState = () => {\n                    const hasValue = !!(sel && sel.value && !sel.options[sel.selectedIndex]?.disabled);\n                    continueBtn.disabled = !hasValue;\n                };\n                if (sel) sel.addEventListener('change', updateContinueState);\n                updateContinueState();\n\n                continueBtn.addEventListener('click', e => {\n                    e.preventDefault();\n                    if (continueBtn.disabled) return;\n\n                    const opt = sel && sel.selectedOptions ? sel.selectedOptions[0] : null;\n\n                    this._selectedFrameworkId        = sel && sel.value ? Number(sel.value) : null;\n                    this._selectedFrameworkShortname = opt\n                        ? (opt.dataset.shortname || opt.textContent.trim())\n                        : null;\n\n                    const selectedFramework = {\n                        id: this._selectedFrameworkId,\n                        shortname: this._selectedFrameworkShortname,\n                    };\n                    this._selectedFramework = selectedFramework;\n\n                    this.showDomains(prompt, selectedFramework);\n                });\n\n            }\n\n            if (backBtn) {\n                backBtn.addEventListener('click', e => {\n                    e.preventDefault();\n                    this.toggleAIDrawer();\n                    this.aiDrawerBodyElement.innerHTML = '';\n                });\n            }\n\n            if (cancelBtn) {\n                cancelBtn.addEventListener('click', e => {\n                    e.preventDefault();\n                    this.setRequestCancelled();\n                    this.toggleAIDrawer();\n                    this.aiDrawerBodyElement.innerHTML = '';\n                });\n            }\n        }\n\n        // === STEP 2: Select domains (checkboxes) ===\n        async showDomains(prompt, framework) {\n            this.aiDrawerBodyElement.dataset.cancelled = '0';\n\n            const html = await Templates.render('aiplacement_classifyassist/domains', { options: [] });\n            this.aiDrawerBodyElement.innerHTML = html;\n\n            let competencies = [];\n\n            try {\n            const args = {\n                filters: [\n                { column: 'competencyframeworkid', value: String(framework.id) },\n                { column: 'parentid',              value: '0' }\n                ],\n                sort: 'shortname',\n                order: 'ASC',\n                skip: 0,\n                limit: 0\n            };\n\n            const requests = Ajax.call([{\n                methodname: 'core_competency_list_competencies',\n                args\n            }]);\n\n            const res = await requests[0];\n\n            competencies = Array.isArray(res?.competencies) ? res.competencies\n                        : Array.isArray(res) ? res\n                        : [];\n\n            competencies = competencies.filter(c => Number(c.parentid || 0) === 0);\n\n            } catch (error) {\n            this.aiDrawerBodyElement.querySelector('.ai-prestep')?.insertAdjacentHTML(\n                'afterbegin',\n                '<div class=\"alert alert-danger mb-3\">Failed to load domains.</div>'\n            );\n            Notification.exception(error);\n            competencies = [];\n            }\n\n            const options = competencies.map(c => {\n            const raw =\n                (c.shortname || '').trim() ||\n                (c.competencyname && c.competencyname.trim?.()) ||\n                (c.idnumber || '').trim() ||\n                (c.description && c.description.replace(/<[^>]+>/g, '').trim()) ||\n                `#${c.id}`;\n\n            const label = raw\n                .replace(/\\b[A-Z]{4,}\\b/g, w => w.charAt(0) + w.slice(1).toLowerCase());\n\n            return {\n                id: `domain-${c.shortname}`,\n                value: String(c.shortname),\n                label,\n            };\n            });\n\n            const finalHtml = await Templates.render('aiplacement_classifyassist/domains', { options });\n            this.aiDrawerBodyElement.innerHTML = finalHtml;\n\n            const cancelBtn   = this.aiDrawerBodyElement.querySelector(SELECTOR_CANCEL);\n            const backBtn     = this.aiDrawerBodyElement.querySelector(SELECTOR_BACK);\n            const continueBtn = this.aiDrawerBodyElement.querySelector(SELECTOR_CONTINUE);\n            const boxes       = this.aiDrawerBodyElement.querySelectorAll(SELECTOR_DOMAINS);\n\n            if (Array.isArray(this._selectedDomains) && this._selectedDomains.length) {\n                const set = new Set(this._selectedDomains.map(String));\n                boxes.forEach(b => { b.checked = set.has(b.value); });\n            }\n\n            const updateContinue = () => {\n                const anyChecked = Array.from(boxes).some(b => b.checked);\n                if (continueBtn) continueBtn.disabled = !anyChecked;\n            };\n            boxes.forEach(b => b.addEventListener('change', updateContinue));\n            updateContinue();\n\n            if (continueBtn) {\n                continueBtn.addEventListener('click', e => {\n                    e.preventDefault();\n                    if (continueBtn.disabled) return;\n\n                    const selectedDomains = Array.from(boxes)\n                        .filter(b => b.checked)\n                        .map(b => b.value);\n\n                    this._selectedDomains = selectedDomains;\n\n                    this.sendClassification(prompt, framework, selectedDomains);\n                });\n            }\n\n            if (backBtn) {\n                backBtn.addEventListener('click', e => {\n                    e.preventDefault();\n                    this.showSelectFramework(prompt);\n                });\n            }\n\n            if (cancelBtn) {\n                cancelBtn.addEventListener('click', e => {\n                    e.preventDefault();\n                    this.setRequestCancelled();\n                    this.toggleAIDrawer();\n                    this.aiDrawerBodyElement.innerHTML = '';\n                });\n            }\n        }\n\n        // === Final: send classification ===\n        async sendClassification(prompt, framework, domains) {\n            if (!prompt) return Notification.error('No prompt provided.');\n            this.aiDrawerBodyElement.dataset.cancelled = '0';\n\n            const loadingHtml = await Templates.render('aiplacement_classifyassist/loading', {});\n            this.aiDrawerBodyElement.innerHTML = loadingHtml;\n\n            const cancelBtn = this.aiDrawerBodyElement.querySelector(SELECTOR_CANCEL);\n            if (cancelBtn) {\n                cancelBtn.addEventListener('click', e => {\n                    e.preventDefault();\n                    this.setRequestCancelled();\n                    this.toggleAIDrawer();\n                    this.aiDrawerBodyElement.innerHTML = '';\n                });\n            }\n\n            try {\n                const fw = framework || this._selectedFramework || {\n                    id: this._selectedFrameworkId,\n                    shortname: this._selectedFrameworkShortname,\n                };\n                const selectedDomains =\n                    (Array.isArray(domains) && domains.length) ? domains :\n                    (Array.isArray(this._selectedDomains) && this._selectedDomains.length) ? this._selectedDomains :\n                    [];\n\n                const calls = Ajax.call([{\n                    methodname: 'aiplacement_classifyassist_classify_text',\n                    args: {\n                        contextid: this.contextId,\n                        prompttext: prompt,\n                        selectedframeworkid: fw?.id || 0,\n                        selectedframeworkshortname: fw?.shortname || '',\n                        domains: selectedDomains,\n                    }\n                }]);\n\n                const result = await calls[0];\n                if (this.isRequestCancelled()) {\n                    this.aiDrawerBodyElement.dataset.cancelled = '0';\n                    return;\n                }\n                console.log(result);\n\n                const {frameworkid, frameworkshortname, useddomains = [], competencies = []} = result;\n                const uniqid  = 'resp-' + Math.random().toString(36).substr(2, 9);\n                const heading = await Str.get_string('classifyheading', 'aiplacement_classifyassist');\n\n                const responseHtml = await Templates.render(\n                    'aiplacement_classifyassist/response',\n                    {\n                        heading,\n                        action: heading,\n                        uniqid,\n                        frameworkid,\n                        frameworkshortname,\n                        useddomains,\n                        competencies,\n                    }\n                );\n\n                this.aiDrawerBodyElement.innerHTML = responseHtml;\n\n                const regen = this.aiDrawerBodyElement.querySelector('[data-action=\"regenerate\"]');\n                if (regen) {\n                    regen.addEventListener('click', e => {\n                        e.preventDefault();\n                        this.sendClassification(prompt, fw, selectedDomains);\n                    });\n                }\n            } catch (error) {\n                if (!this.isRequestCancelled()) {\n                    const errorHtml = await Templates.render('aiplacement_classifyassist/error', {});\n                    this.aiDrawerBodyElement.innerHTML = errorHtml;\n                    Notification.exception(error);\n                }\n            } finally {\n                this.aiDrawerBodyElement.dataset.cancelled = '0';\n            }\n        }\n    };\n});\n"],"names":["define","Base","Templates","Ajax","Notification","Str","constructor","userId","contextId","aiDrawerElement","document","querySelector","aiDrawerBodyElement","this","aiDrawerCloseElement","addEventListener","e","preventDefault","closeAIDrawer","_domains","registerExtraListener","async","target","closest","openAIDrawer","prompt","tex","value","trim","getTextContent","showSelectFramework","error","dataset","cancelled","prestepHtml","render","innerHTML","select","calls","call","methodname","args","sort","order","skip","context","contextid","instanceid","res","frameworks","Array","isArray","length","ph","createElement","disabled","selected","textContent","appendChild","forEach","fw","opt","String","id","shortname","name","idnumber","exception","continueBtn","sel","backBtn","cancelBtn","updateContinueState","hasValue","options","selectedIndex","_sel$options$sel$sele","selectedOptions","_selectedFrameworkId","Number","_selectedFrameworkShortname","selectedFramework","_selectedFramework","showDomains","toggleAIDrawer","setRequestCancelled","framework","html","competencies","filters","column","limit","requests","filter","c","parentid","insertAdjacentHTML","map","label","competencyname","_c$competencyname$tri","description","replace","w","charAt","slice","toLowerCase","finalHtml","boxes","querySelectorAll","_selectedDomains","set","Set","b","checked","has","updateContinue","anyChecked","from","some","selectedDomains","sendClassification","domains","loadingHtml","prompttext","selectedframeworkid","selectedframeworkshortname","result","isRequestCancelled","console","log","frameworkid","frameworkshortname","useddomains","uniqid","Math","random","toString","substr","heading","get_string","responseHtml","action","regen","errorHtml"],"mappings":"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"}